<!DOCTYPE html>
<html>
<head>
<title>Masjid Website</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<h2>ðŸ”Ž Search Audio</h2>
<input type="text" id="search" placeholder="Search..." onkeyup="filterAudio()">

<hr>

<h2>ðŸŽµ Audios</h2>
<div id="audioList"></div>

<hr>

<h2>ðŸ•Œ Ratiba ya Swala</h2>
<div id="schedule"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, getDocs, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyDsuZ_Ks_VMEo62P-9n0G2Q-UShD_FD6rE",
authDomain: "masjid-shabaab-daa-wah-4f49b.firebaseapp.com",
projectId: "masjid-shabaab-daa-wah-4f49b",
storageBucket: "masjid-shabaab-daa-wah-4f49b.firebasestorage.app",
messagingSenderId: "287019093594",
appId: "1:287019093594:web:1b343aed72f3433b36d263"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let audios = [];

async function loadAudios(){
const snapshot = await getDocs(collection(db,"audios"));
audios = snapshot.docs.map(doc => doc.data());
displayAudios(audios);
}

function displayAudios(list){
let html = "";
list.forEach(a=>{
html += `
<h3>${a.title}</h3>
<p>${a.category}</p>
<audio controls>
<source src="${a.audio}">
</audio>
<br>
<a href="${a.audio}" download>â¬‡ Download</a>
<hr>
`;
});
document.getElementById("audioList").innerHTML = html;
}

window.filterAudio = function(){
const value = document.getElementById("search").value.toLowerCase();
const filtered = audios.filter(a =>
a.title.toLowerCase().includes(value)
);
displayAudios(filtered);
}

async function loadSchedule(){
const snap = await getDoc(doc(db,"salah_schedule","today"));
if(snap.exists()){
const data = snap.data();
document.getElementById("schedule").innerHTML = `
Fajr: ${data.fajr}<br>
Dhuhr: ${data.dhuhr}<br>
Asr: ${data.asr}<br>
Maghrib: ${data.maghrib}<br>
Isha: ${data.isha}
`;
}
}

loadAudios();
loadSchedule();

</script>

</body>
</html>
