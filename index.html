<!DOCTYPE html>
<html>
<head>
<title>MASJID SHABAABDAA'WAH BUHONGWA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
margin:0;
font-family: Arial, sans-serif;
background:#f4f6f9;
}

.header{
position:relative;
text-align:center;
color:white;
}

.header img{
width:100%;
height:250px;
object-fit:cover;
filter:brightness(60%);
}

.header h1{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
font-size:22px;
}

.section{
padding:15px;
}

.card{
background:white;
padding:15px;
margin-bottom:15px;
border-radius:10px;
box-shadow:0 4px 8px rgba(0,0,0,0.1);
}

button{
background:#1e7e34;
color:white;
border:none;
padding:8px 12px;
border-radius:5px;
}

audio{
width:100%;
margin-top:10px;
}

.search{
width:100%;
padding:10px;
margin-bottom:15px;
border-radius:8px;
border:1px solid #ccc;
}

.schedule{
background:#1e7e34;
color:white;
padding:15px;
border-radius:10px;
}
</style>

</head>
<body>

<div class="header">
<img src="mosque.jpg">
<h1>MASJID SHABAABDAA'WAH BUHONGWA</h1>
</div>

<div class="section">

<input type="text" id="search" class="search" placeholder="ðŸ”Ž Search khutbah..." onkeyup="filterAudio()">

<h2>ðŸŽ§ Khutbah & Darsa</h2>
<div id="audioList"></div>

<h2>ðŸ•Œ Ratiba ya Swala</h2>
<div id="schedule" class="schedule"></div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, getDocs, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "WEKA_API_KEY",
authDomain: "masjid-shabaab-daa-wah-4f49b.firebaseapp.com",
projectId: "masjid-shabaab-daa-wah-4f49b",
storageBucket: "masjid-shabaab-daa-wah-4f49b.firebasestorage.app",
messagingSenderId: "287019093594",
appId: "1:287019093594:web:1b343aed72f3433b36d263"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let audios = [];

async function loadAudios(){
const snapshot = await getDocs(collection(db,"audios"));
audios = snapshot.docs.map(doc => doc.data());
displayAudios(audios);
}

function displayAudios(list){
let html="";
list.forEach(a=>{
html+=`
<div class="card">
<h3>${a.title}</h3>
<p>${a.category}</p>
<audio controls>
<source src="${a.audio}">
</audio>
<br>
<a href="${a.audio}" download><button>â¬‡ Download</button></a>
</div>
`;
});
document.getElementById("audioList").innerHTML=html;
}

window.filterAudio=function(){
const value=document.getElementById("search").value.toLowerCase();
const filtered=audios.filter(a=>a.title.toLowerCase().includes(value));
displayAudios(filtered);
}

async function loadSchedule(){
const snap=await getDoc(doc(db,"salah_schedule","today"));
if(snap.exists()){
const data=snap.data();
document.getElementById("schedule").innerHTML=
`Fajr: ${data.fajr}<br>
Dhuhr: ${data.dhuhr}<br>
Asr: ${data.asr}<br>
Maghrib: ${data.maghrib}<br>
Isha: ${data.isha}`;
}
}

loadAudios();
loadSchedule();
</script>

</body>
</html>
